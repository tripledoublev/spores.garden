{
  "lexicon": 1,
  "id": "garden.spores.site.section",
  "defs": {
    "main": {
      "type": "record",
      "key": "tid",
      "description": "A single site section for spores.garden. Each section is a record in a collection.",
      "record": {
        "type": "object",
        "required": ["type"],
        "properties": {
          "type": {
            "type": "string",
            "knownValues": ["collection", "records", "content", "block", "profile", "share-to-bluesky", "collected-flowers"],
            "description": "Section type"
          },
          "title": {
            "type": "string",
            "maxGraphemes": 200,
            "maxLength": 2000,
            "description": "Section title"
          },
          "layout": {
            "type": "string",
            "knownValues": ["post", "card", "image", "link", "links", "list", "profile", "raw"],
            "description": "Layout to use for rendering"
          },
          "data": {
            "type": "union",
            "closed": false,
            "refs": ["#recordRefData", "#recordsData", "#emptyData"],
            "description": "Typed section payload. Preferred over legacy optional top-level fields."
          },
          "collection": {
            "type": "string",
            "description": "Deprecated legacy field. Collection NSID to display."
          },
          "rkey": {
            "type": "string",
            "description": "Deprecated legacy field. Record key within the collection to display."
          },
          "records": {
            "type": "array",
            "items": { "type": "string", "format": "at-uri" },
            "description": "Deprecated legacy field. Specific record URIs to display."
          },
          "content": {
            "type": "string",
            "maxGraphemes": 50000,
            "maxLength": 500000,
            "description": "Deprecated legacy field. Inline content for block sections."
          },
          "format": {
            "type": "string",
            "knownValues": ["markdown", "html", "text"],
            "description": "Content format"
          },
          "limit": {
            "type": "integer",
            "minimum": 1,
            "maximum": 100,
            "description": "Maximum records to display"
          },
          "ref": {
            "type": "string",
            "format": "at-uri",
            "description": "AT-URI of the referenced record (for content/profile sections)"
          },
          "hideHeader": {
            "type": "boolean",
            "description": "If true, hides the section header in display mode"
          }
        }
      }
    },
    "recordRefData": {
      "type": "object",
      "required": ["ref"],
      "properties": {
        "ref": {
          "type": "string",
          "format": "at-uri",
          "description": "Referenced record AT-URI for profile/content sections."
        }
      }
    },
    "recordsData": {
      "type": "object",
      "required": ["records"],
      "properties": {
        "records": {
          "type": "array",
          "items": { "type": "string", "format": "at-uri" },
          "description": "Specific record URIs to render."
        },
        "collection": {
          "type": "string",
          "description": "Optional source collection hint."
        },
        "limit": {
          "type": "integer",
          "minimum": 1,
          "maximum": 100,
          "description": "Optional render limit."
        }
      }
    },
    "emptyData": {
      "type": "object",
      "description": "No additional payload required for this section type."
    }
  }
}
